# YouTube 视频下载说明

## 问题现象
- 下载的文件名为 `tunnel.mp4`
- 文件只有声音没有画面

## 问题原因
YouTube 的高质量视频（1080p及以上）采用分离存储：
- **视频流**：无音频的视频文件
- **音频流**：无视频的音频文件

这是 YouTube 的技术架构，不是 cobalt 的问题。

## 解决方案

### 方案1：使用预览界面（推荐）
1. 输入 YouTube 链接后点击下载
2. 如果检测到需要合并的文件，会弹出预览界面
3. 在预览界面中可以：
   - 查看视频信息
   - 预览视频内容（无声音）
   - 了解合并说明
   - 下载分离的文件

### 方案2：使用 FFmpeg 合并
下载分离文件后，使用以下命令合并：

```bash
ffmpeg -i "视频文件.mp4" -i "音频文件.m4a" -c copy "合并后的视频.mp4"
```

### 方案3：使用视频编辑软件
推荐的视频编辑软件：
- **FFmpeg**（命令行，最快）
- **DaVinci Resolve**（免费专业软件）
- **Adobe Premiere Pro**
- **Final Cut Pro**（Mac）

## 技术说明

### 为什么会出现分离文件？
1. **YouTube 的 DASH 技术**：高质量视频使用自适应比特率流
2. **带宽优化**：根据网络情况动态选择视频和音频质量
3. **存储效率**：避免重复存储不同质量组合的完整视频

### cobalt 的处理方式
1. **服务器处理**（设置中的推荐选项）：
   - API 服务器尝试获取完整视频
   - 如果无法获取，返回分离文件
   
2. **本地处理**（高级选项）：
   - 直接返回分离文件
   - 需要用户手动合并

## 当前设置
- 默认强制使用"服务器处理"模式
- 如果仍然返回分离文件，说明 YouTube 只提供分离流
- 这种情况下会显示预览界面，让用户了解情况并选择下载

## 常见问题

### Q: 为什么不自动合并？
A: 在浏览器中进行视频合并需要：
- 下载两个文件到内存
- 使用 WebAssembly FFmpeg 进行合并
- 消耗大量内存和处理时间
- 可能导致浏览器卡顿或崩溃

### Q: 其他下载工具为什么没有这个问题？
A: 
- 大多数工具只支持低质量视频（720p及以下）
- 或者在服务器端预先合并（需要强大的服务器资源）
- 或者使用了不同的技术路线

### Q: 能否添加自动合并功能？
A: 技术上可行，但需要权衡：
- 增加服务器负载
- 增加下载等待时间
- 可能影响服务稳定性

当前方案平衡了功能性和可用性。 